<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>弹球小游戏</title>
    <style>
        #gameArea {
            position: relative;
            width: 400px;
            height: 400px;
            border: 2px solid black;
            margin: 0 auto;
            background-color: #f0f0f0;
            display: none; /* 初始隐藏游戏区域 */
        }
        #paddle {
            position: absolute;
            width: 80px;
            height: 10px;
            background-color: red;
            bottom: 0;
            left: 160px;
        }
        #ball {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: blue;
            border-radius: 50%;
            top: 190px;
            left: 190px;
        }
        #score, #lives, #gameOver {
            text-align: center;
            font-size: 20px;
        }
        #gameOver {
            display: none;
            color: red;
            font-size: 24px;
            font-weight: bold;
        }
        button {
            display: block;
            margin: 10px auto;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- 开始游戏按钮 -->
    <button id="startBtn" style="display: block; margin: 0 auto;">开始游戏</button>

    <div id="gameArea">
        <div id="paddle"></div>
        <div id="ball"></div>
    </div>

    <div id="score">得分: 0</div>
    <div id="lives">生命值: 3</div>
    <div id="gameOver">游戏结束</div>
    <button id="restartBtn" style="display:none;">重新开始</button>
    <button id="pauseBtn" style="display: none;">暂停</button>

    <script>
        let startBtn = document.getElementById('startBtn');
        let gameArea = document.getElementById('gameArea');
        let paddle = document.getElementById('paddle');
        let ball = document.getElementById('ball');
        let scoreDisplay = document.getElementById('score');
        let livesDisplay = document.getElementById('lives');
        let gameOverDisplay = document.getElementById('gameOver');
        let restartBtn = document.getElementById('restartBtn');
        let pauseBtn = document.getElementById('pauseBtn');

        let score = 0;
        let lives = 3;
        let ballSpeedX = (Math.random() * 2 - 1) * 4; // 随机的水平速度
        let ballSpeedY = 4;
        let ballX = 200;
        let ballY = 0;
        let paddleX = 160;
        let gameInterval;
        let isPaused = false;

        // 保存初始球速
        let initialSpeedX = ballSpeedX;
        let initialSpeedY = ballSpeedY;

        // 鼠标移动挡板
        function movePaddle(event) {
            let rect = gameArea.getBoundingClientRect();
            paddleX = event.clientX - rect.left - paddle.offsetWidth / 2;
            if (paddleX < 0) {
                paddleX = 0;
            } else if (paddleX > gameArea.offsetWidth - paddle.offsetWidth) {
                paddleX = gameArea.offsetWidth - paddle.offsetWidth;
            }
            paddle.style.left = paddleX + 'px';
        }

        // 更新球的状态
        function updateBall() {
            ballX += ballSpeedX;
            ballY += ballSpeedY;
            ball.style.left = ballX + 'px';
            ball.style.top = ballY + 'px';

            // 碰撞检测：边界
            if (ballX <= 0 || ballX >= 380) {
                ballSpeedX = -ballSpeedX;
            }
            if (ballY <= 0) {
                ballSpeedY = -ballSpeedY;

            }

            // 碰撞检测：挡板
            if (ballY >= 370 && ballX >= paddleX && ballX <= paddleX + 80) {
                if (ballSpeedY > 0) { // 只有球向下运动时才有效
                    ballSpeedY = -ballSpeedY;
                    score++;
                    scoreDisplay.textContent = '得分: ' + score;

                    if (score % 3 === 0) { // 每3分球速增加
                        ballSpeedX *= 1.1;
                        ballSpeedY *= 1.1;
                    }
                }
            }

            // 碰撞检测：底部
            if (ballY >= 400) {
                lives--;
                livesDisplay.textContent = '生命值: ' + lives;
                
                if (lives === 0) {
                    gameOver();
                } else {
                    resetBall();
                }
            }

            // 设置球速上限
            const maxSpeed = 10; // 设置球速上限为10
            if (Math.abs(ballSpeedX) > maxSpeed) {
                ballSpeedX = Math.sign(ballSpeedX) * maxSpeed;
            }
            if (Math.abs(ballSpeedY) > maxSpeed) {
                ballSpeedY = Math.sign(ballSpeedY) * maxSpeed;
            }
        }

        // 游戏结束
        function gameOver() {
            clearInterval(gameInterval);
            gameOverDisplay.style.display = 'block';
            restartBtn.style.display = 'block';
        }

        // 重置球的位置
        function resetBall() {
            ballX = 200;
            ballY = 0;
        }

        // 暂停游戏
        function togglePause() {
            if (isPaused) {
                gameInterval = setInterval(updateBall, 10);
                pauseBtn.textContent = '暂停';
            } else {
                clearInterval(gameInterval);
                pauseBtn.textContent = '继续';
            }
            isPaused = !isPaused;
        }

        // 重新开始游戏
        function restartGame() {
            score = 0;
            lives = 3;
            ballSpeedX = initialSpeedX;
            ballSpeedY = initialSpeedY;
            scoreDisplay.textContent = '得分: ' + score;
            livesDisplay.textContent = '生命值: ' + lives;
            gameOverDisplay.style.display = 'none';
            restartBtn.style.display = 'none';
            resetBall();
            gameInterval = setInterval(updateBall, 10);
        }

        // 开始游戏
        function startGame() {
            gameArea.style.display = 'block'; // 显示游戏区域
            startBtn.style.display = 'none'; // 隐藏开始按钮
            pauseBtn.style.display = 'block'; // 显示暂停按钮
            gameInterval = setInterval(updateBall, 10); // 启动游戏
        }

        // 监听鼠标移动事件
        gameArea.addEventListener('mousemove', movePaddle);

        // 开始按钮点击事件
        startBtn.addEventListener('click', startGame);

        // 暂停按钮事件
        pauseBtn.addEventListener('click', togglePause);

        // 重新开始按钮事件
        restartBtn.addEventListener('click', restartGame);
    </script>    
</body>
</html>
